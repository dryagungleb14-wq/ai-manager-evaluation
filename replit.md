# AI-сервис оценки работы менеджеров

## Описание проекта
Пилотный веб-сервис для автоматической оценки качества работы менеджеров через анализ звонков и переписок с клиентами. Система использует AI для проверки диалогов по настраиваемым чек-листам, выявления возражений и формирования детальных отчётов.

## Технологический стек

### Frontend
- **React** с TypeScript
- **Vite** для сборки
- **Tailwind CSS** + **Shadcn UI** для стилизации
- **Wouter** для роутинга
- **React Query** для управления состоянием
- **React Dropzone** для загрузки файлов

### Backend
- **Node.js** + **Express**
- **OpenAI Whisper API** для распознавания речи (ASR)
- **Google Gemini API** для анализа диалогов (LLM)
- **Multer** для обработки файлов
- **Zod** для валидации данных

### Хранение данных
- In-memory storage для чек-листов и истории анализов (MVP)
- LocalStorage в браузере для пользовательских чек-листов

## Основные возможности

### 1. Анализ звонков
- Загрузка аудиофайлов (MP3, WAV, M4A, OGG, FLAC)
- Автоматическая транскрипция через OpenAI Whisper
- Редактирование расшифровки перед анализом
- Сохранение таймкодов для цитат

### 2. Анализ переписок
- Ввод текста вручную или загрузка .txt файлов
- Поддержка drag-and-drop интерфейса
- Валидация и предобработка текста

### 3. Управление чек-листами
- Создание и редактирование чек-листов
- Три типа пунктов: обязательный, рекомендуемый, запрещённый
- Импорт/экспорт в JSON формате
- Дублирование чек-листов
- Предзагруженные примеры для B2B продаж и поддержки

### 4. AI-анализ
- Проверка диалога по всем пунктам чек-листа
- Оценка выполнения с уверенностью (0-1)
- Извлечение цитат с таймкодами
- Автоматическое выявление возражений клиента
- Категоризация возражений
- Оценка качества обработки возражений
- Формирование сути разговора (1-3 предложения)
- Фиксация итога и следующих шагов

### 5. Отчёты
- **Отчёт по чек-листу**: статусы, оценки, цитаты, общая сводка
- **Отчёт по возражениям**: категории, обработка, рекомендации
- Визуальное отображение с прогресс-барами и иконками
- Адаптивный дизайн для всех устройств

## Структура проекта

```
├── client/                    # Frontend приложение
│   ├── src/
│   │   ├── components/       # React компоненты
│   │   │   ├── ui/          # Shadcn UI компоненты
│   │   │   ├── audio-upload.tsx
│   │   │   ├── text-input.tsx
│   │   │   ├── transcript-editor.tsx
│   │   │   ├── checklist-selector.tsx
│   │   │   ├── checklist-editor.tsx
│   │   │   ├── analysis-results.tsx
│   │   │   └── theme-toggle.tsx
│   │   ├── lib/             # Утилиты
│   │   │   ├── theme-provider.tsx
│   │   │   ├── default-checklists.ts
│   │   │   └── checklist-storage.ts
│   │   ├── pages/           # Страницы
│   │   │   ├── home.tsx
│   │   │   └── not-found.tsx
│   │   └── App.tsx
│   └── index.html
├── server/                   # Backend сервер
│   ├── routes.ts            # API endpoints
│   ├── storage.ts           # Интерфейс хранилища
│   ├── services/            # Бизнес-логика
│   │   ├── whisper.ts      # OpenAI Whisper интеграция
│   │   └── gemini.ts       # Gemini AI интеграция
│   └── index.ts
├── shared/                   # Общий код
│   └── schema.ts            # Типы и схемы Zod
└── design_guidelines.md     # Дизайн-система проекта
```

## API Endpoints

### POST /api/transcribe
Транскрибация аудио в текст
- **Input**: multipart/form-data с аудиофайлом
- **Output**: { transcript, language }

### POST /api/analyze
Анализ диалога по чек-листу
- **Input**: { transcript, checklist, language?, source }
- **Output**: { checklistReport, objectionsReport }

## Переменные окружения

```
OPENAI_API_KEY=...     # Ключ для OpenAI Whisper API
GEMINI_API_KEY=...     # Ключ для Google Gemini API
```

## Запуск проекта

### Локально
```bash
npm install
npm run dev
```

### На Replit
Проект автоматически запускается через команду `npm run dev`, которая:
1. Запускает Vite dev server на порту 5000 (frontend)
2. Запускает Express server (backend с API)

## Особенности реализации

### Дизайн-система
- **Темная тема** по умолчанию с поддержкой светлой
- **Цветовая палитра**: Professional B2B стиль
- **Типографика**: Inter для UI, JetBrains Mono для кода
- **Компоненты**: Полностью на Shadcn UI
- **Иконки**: Lucide React

### Обработка ошибок
- Graceful error handling с информативными сообщениями
- Toast-уведомления для пользователя
- Возможность повтора запроса при ошибке
- Валидация данных на клиенте и сервере

### AI Промпты
- Структурированные промпты для Gemini
- JSON Schema validation для ответов
- Поддержка русского языка
- Обработка edge cases (нет возражений, неполные данные)

## Следующие этапы (Post-MVP)

1. **Экспорт отчётов**: PDF и Markdown форматы
2. **База данных**: PostgreSQL для постоянного хранения
3. **Мультиязычность**: Поддержка английского языка
4. **Аналитика**: Статистика по менеджерам и периодам
5. **Vercel deployment**: Оптимизация для serverless
6. **Офлайн режим**: Локальные ASR/LLM модели

## Дизайн-решения

### Почему Gemini вместо GPT?
- Бесплатный tier с щедрыми лимитами
- Отличная поддержка русского языка
- Structured output с JSON Schema
- Быстрые ответы для анализа

### Почему in-memory storage?
- Простота для MVP/пилота
- Быстрая разработка без настройки БД
- Легко мигрировать на PostgreSQL позже
- Достаточно для демонстрации концепции

### Почему клиентское хранение чек-листов?
- Приватность данных пользователя
- Работает оффлайн для редактирования
- Простой импорт/экспорт
- Не требует аутентификации для MVP
